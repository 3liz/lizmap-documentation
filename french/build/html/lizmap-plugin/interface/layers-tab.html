

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Couches - Configurer les couches avec le plugin &mdash; Lizmap 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Lizmap 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Interface - Les onglets" href="index.html" />
    <link rel="next" title="Carte - Configurer la carte web avec le plugin" href="map-tab.html" />
    <link rel="prev" title="Interface - Les onglets" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="map-tab.html" title="Carte - Configurer la carte web avec le plugin"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Interface - Les onglets"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Lizmap 1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Le plugin Lizmap pour QGIS</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Interface - Les onglets</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Couches - Configurer les couches avec le plugin</a><ul>
<li><a class="reference internal" href="#lizmap-plugin-l-onglet-couches">Lizmap plugin - l&#8217;onglet Couches</a><ul>
<li><a class="reference internal" href="#transformer-les-groupes-racines-en-blocs-de-legende">Transformer les groupes racines en blocs de légende</a></li>
</ul>
</li>
<li><a class="reference internal" href="#les-metadonnees">Les métadonnées</a><ul>
<li><a class="reference internal" href="#titre">Titre</a></li>
<li><a class="reference internal" href="#resume">Résumé</a></li>
<li><a class="reference internal" href="#lien">Lien</a></li>
</ul>
</li>
<li><a class="reference internal" href="#options-liees-a-la-carte">Options liées à la carte</a><ul>
<li><a class="reference internal" href="#activer-les-popups">Activer les popups</a></li>
<li><a class="reference internal" href="#groupe-comme-une-couche">Groupe comme une couche ?</a></li>
<li><a class="reference internal" href="#fond-de-carte">Fond de carte ?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#options-d-optimisation">Options d&#8217;optimisation</a><ul>
<li><a class="reference internal" href="#image-non-tuilee">Image non tuilée ?</a></li>
<li><a class="reference internal" href="#format-d-image">Format d&#8217;image</a></li>
</ul>
</li>
<li><a class="reference internal" href="#utiliser-le-cache">Utiliser le cache</a><ul>
<li><a class="reference internal" href="#cache-serveur">Cache Serveur ?</a></li>
<li><a class="reference internal" href="#cache-client-navigateur">Cache client navigateur</a></li>
<li><a class="reference internal" href="#remarques">Remarques</a></li>
</ul>
</li>
<li><a class="reference internal" href="#centraliser-le-cache-via-l-integration-de-groupes-et-couches-d-un-projet-parent">Centraliser le cache via l&#8217;intégration de groupes et couches d&#8217;un projet parent</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Interface - Les onglets</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="map-tab.html"
                        title="next chapter">Carte - Configurer la carte web avec le plugin</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/lizmap-plugin/interface/layers-tab.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="couches-configurer-les-couches-avec-le-plugin">
<span id="layers-tab"></span><h1>Couches - Configurer les couches avec le plugin<a class="headerlink" href="#couches-configurer-les-couches-avec-le-plugin" title="Permalink to this headline">¶</a></h1>
<div class="section" id="lizmap-plugin-l-onglet-couches">
<h2>Lizmap plugin - l&#8217;onglet Couches<a class="headerlink" href="#lizmap-plugin-l-onglet-couches" title="Permalink to this headline">¶</a></h2>
<p>Cet onglet montre l&#8217;arbre des couches identique à celui présenté dans le panneau légende de QGIS. On peut sélectionner l&#8217;un des éléments de l&#8217;abre, une couche ou un groupe, puis configurer les options pour le groupe ou la couche sélectionnée.</p>
<img alt="../../_images/interface-layers-tab.png" class="align-center" src="../../_images/interface-layers-tab.png" style="width: 80%;" />
<div class="section" id="transformer-les-groupes-racines-en-blocs-de-legende">
<h3>Transformer les groupes racines en blocs de légende<a class="headerlink" href="#transformer-les-groupes-racines-en-blocs-de-legende" title="Permalink to this headline">¶</a></h3>
<p>Si votre projet contient des groupes de premier niveau, comme ici</p>
<div class="highlight-none"><div class="highlight"><pre>-- groupe_a
  |-- une couche
  |-- un sous-groupe
    |-- une autre couche
-- groupe_b
  |-- une couche
etc.
</pre></div>
</div>
<p>Vous pouvez alors cocher cette option et alors :</p>
<ul class="simple">
<li>la légende de Lizmap Web Client sera séparée en autant de blocs de légende que de groupes parent</li>
<li>le nom des groupes parents ne sera pas visible.</li>
<li>L&#8217;application Web ajoute automatiquement des classes aux objets HTML générés, ce qui rend possible aux utilisateurs avancés de modifier le style pour chacun des groupes obtenus.</li>
</ul>
<p>Dans notre exemple, on obtiendrai alors la légende suivante dans la légende de Lizmap Web Client</p>
<div class="highlight-none"><div class="highlight"><pre>[x] une couche
[x] un sous-groupe
   [x] une autre couche

[x] une couche
etc.
</pre></div>
</div>
</div>
</div>
<div class="section" id="les-metadonnees">
<span id="layers-tab-metadata"></span><h2>Les métadonnées<a class="headerlink" href="#les-metadonnees" title="Permalink to this headline">¶</a></h2>
<div class="section" id="titre">
<h3>Titre<a class="headerlink" href="#titre" title="Permalink to this headline">¶</a></h3>
<p>le titre du groupe/de la couche.</p>
<ul class="simple">
<li>Ce titre sera affiché dans l&#8217;application web Lizmap au lieu du nom réel.</li>
</ul>
</div>
<div class="section" id="resume">
<h3>Résumé<a class="headerlink" href="#resume" title="Permalink to this headline">¶</a></h3>
<p>une courte description du groupe/de la couche.</p>
<ul class="simple">
<li>Cette description sera affichée au survol du nom de la couche.</li>
</ul>
</div>
<div class="section" id="lien">
<h3>Lien<a class="headerlink" href="#lien" title="Permalink to this headline">¶</a></h3>
<p>un lien html, comme par exemple &#8220;<a class="reference external" href="http://qgis.org">http://qgis.org</a>&#8221; ou un document du répertoire <strong>media</strong></p>
<ul class="simple">
<li>Une icone (i) s&#8217;affiche à droite du groupe ou de la couche et permet d&#8217;ouvrir le lien ou le document</li>
<li>Pour savoir comment utiliser les documents stockés dans le répertoire <em>media</em> situé au même niveau que le projet QGIS, voir <a class="reference internal" href="../features/medias.html#media-in-lizmap"><em>Les médias dans Lizmap</em></a></li>
</ul>
</div>
</div>
<div class="section" id="options-liees-a-la-carte">
<h2>Options liées à la carte<a class="headerlink" href="#options-liees-a-la-carte" title="Permalink to this headline">¶</a></h2>
<div class="section" id="activer-les-popups">
<span id="layers-tab-popups"></span><h3>Activer les popups<a class="headerlink" href="#activer-les-popups" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>permet d&#8217;activer les fenêtres d&#8217;information sur interrogation de la carte par clic. Voir <a class="reference internal" href="../features/popups.html#popups-in-lizmap"><em>Configurer les popups dans Lizmap</em></a></li>
</ul>
</div>
<div class="section" id="groupe-comme-une-couche">
<h3>Groupe comme une couche ?<a class="headerlink" href="#groupe-comme-une-couche" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Vous pouvez transformer un groupe Qgis en une couche unique dans la légende de l&#8217;application Lizmap Web Client. Les fils de ce groupe ne seront pas visibles dans l&#8217;arbre, mais le seront sur la carte. La légende montrera la légende de tous les fils.</li>
<li><strong>Attention</strong> : lorsque vous utiliser cette option, il est inutile de configurer les options pour les couches et les groupes fils de ce groupe. Ces options seront ignorées par Lizmap Web Client. Sauf pour les popups ou il faut bien cocher les couches filles à faire figurer dans la popup du groupe.</li>
</ul>
</div>
<div class="section" id="fond-de-carte">
<h3>Fond de carte ?<a class="headerlink" href="#fond-de-carte" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>permet de basculer le groupe/la couche dans la liste des fonds de carte. Une seule couche de fond peut être affichée à la fois</li>
</ul>
</div>
</div>
<div class="section" id="options-d-optimisation">
<h2>Options d&#8217;optimisation<a class="headerlink" href="#options-d-optimisation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="image-non-tuilee">
<h3>Image non tuilée ?<a class="headerlink" href="#image-non-tuilee" title="Permalink to this headline">¶</a></h3>
<p>une seule image est crée pour toute la largeur et la hauteur de la carte visible sur l&#8217;application Web.</p>
<ul class="simple">
<li>Cette option peut être cochée pour éviter les problèmes d&#8217;étiquettes tronquées ou de trames hachurées décalées.</li>
<li><strong>Attention</strong> Cette option n&#8217;est pas compatible avec l&#8217;activation du Cache**</li>
</ul>
</div>
<div class="section" id="format-d-image">
<h3>Format d&#8217;image<a class="headerlink" href="#format-d-image" title="Permalink to this headline">¶</a></h3>
<p>3 formats</p>
<ul class="simple">
<li><em>Png</em> est souvent le meilleur choix, car ce format respecte la transparence.</li>
<li><em>Png 8bit</em> produit des images moins lourdes (donc plus rapides à télécharger), mais gère une palette limitée de couleur et ne gère pas la transparence.</li>
<li><em>jpeg</em> créée des images opaques, légères mais avec une dégradation visible</li>
</ul>
<p><strong>Nous conseillons vivement d&#8217;utiliser le format jpeg pour les fonds de carte, puisqu&#8217;ils la transparence est alors inutile</strong></p>
</div>
</div>
<div class="section" id="utiliser-le-cache">
<h2>Utiliser le cache<a class="headerlink" href="#utiliser-le-cache" title="Permalink to this headline">¶</a></h2>
<p>Lizmap Web Client sait créer dynamiquement un cache des tuiles sur le serveur, et permet aussi d&#8217;utiliser le cache du navigateur. Cela permet d&#8217;améliorer les performances de consultation. L&#8217;activation des caches se fait via le plugin, couche par couche.</p>
<div class="section" id="cache-serveur">
<h3>Cache Serveur ?<a class="headerlink" href="#cache-serveur" title="Permalink to this headline">¶</a></h3>
<p>A cocher pour activer le cache automatique pour la couche ou le groupe. Ce cache représente le stokage sur le serveur des images déjà générées par le serveur QGIS. L&#8217;application Lizmap Web Client génère automatiquement le cache au fur et à mesure que les tuiles sont demandées. Activer le cache permet d&#8217;alléger fortement la charge sur le serveur, puisqu&#8217;on ne redemande pas à QGIS les tuiles qui ont déjà été rendues.</p>
<p>2 options permettent de configurer le cache Serveur :</p>
<ul class="simple">
<li><strong>Expiration (secondes)</strong> : permet de préciser le temps d&#8217;expiration du cache serveur en secondes.</li>
<li><strong>Metatile</strong> : demande une image plus grande au serveur en fonction du paramètre passé puis redécoupe. Cela évite les étiquettes tronquées au bords et les discontinuités entre tuiles, mais est plus gourmand en ressources. Valeur par défaut : 5,5.</li>
</ul>
</div>
<div class="section" id="cache-client-navigateur">
<h3>Cache client navigateur<a class="headerlink" href="#cache-client-navigateur" title="Permalink to this headline">¶</a></h3>
<p>Cette option permet de spécifier un temps d&#8217;expiration pour les tuiles en seconde. Lorsqu&#8217;on parcours la carte Lizmap avec le navigateur, celui-ci stocke les tuiles qu&#8217;il affiche dans son cache. Activer le cache client permet d&#8217;optimiser fortement Lizmap, car le navigateur ne re-demande pas au serveur les tuiles qu&#8217;il a déjà en cache et qui ne sont pas expirées.</p>
<p>Nous conseillons de mettre la valeur maximale (1 mois soit 24 x 3600 x 30 = 2592000 secondes), sauf bien sûr pour les couches dont la donnée change souvent.</p>
</div>
<div class="section" id="remarques">
<h3>Remarques<a class="headerlink" href="#remarques" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Le cache doit être activé seulement une fois le rendu bien maîtrisé</strong>, lorsqu&#8217;on souhaite passer le projet en production.</li>
<li><strong>Les 2 modes de cache Serveur et Client sont complètement indépendants</strong> l&#8217;un de l&#8217;autre. Mais bien sûr, il est intéressant d&#8217;utiliser les 2 en même temps pour optimiser l&#8217;application et libérer les ressources du serveur.</li>
</ul>
</div>
</div>
<div class="section" id="centraliser-le-cache-via-l-integration-de-groupes-et-couches-d-un-projet-parent">
<span id="layers-tab-embedded"></span><h2>Centraliser le cache via l&#8217;intégration de groupes et couches d&#8217;un projet parent<a class="headerlink" href="#centraliser-le-cache-via-l-integration-de-groupes-et-couches-d-un-projet-parent" title="Permalink to this headline">¶</a></h2>
<p>Dans QGIS, il est possible d&#8217;intégrer dans un projet des groupes ou des couches depuis un autre projet (qu&#8217;on appellera &#8220;parent&#8221;). Cette technique est intéressante, car elle permet de définir les propriétés des couches une seule fois dans un projet, par exemple pour les fonds de carte (Dans les projets &#8220;fils&#8221; qui intègrent ces couches, il n&#8217;est pas possible de modifier les propriétés)</p>
<p>Lizmap utilise cette fonctionnalité pour centraliser le cache des tuiles. Pour tous les projets fils qui utilisent des couches intégrées du projet parent, Lizmap demandera à QGIS Server les tuiles du projet parent, et non des projets fils. Le cache sera donc centralisé au niveau du projet parent, et tous les projets fils qui utilisent les couches bénéficieront du cache mis en commun.</p>
<p>Pour pouvoir utiliser cette fonctionnalité, il faut</p>
<ul class="simple">
<li><strong>publier le projet QGIS parent avec Lizmap</strong>.<ul>
<li>il faut bien <strong>choisir l&#8217;emprise annoncée</strong> dans l&#8217;onglet <em>Serveur Ows</em> des propriétés du projet, car cette <strong>emprise devra être réutilisée à l&#8217;identique dans les projets fils.</strong></li>
<li>il faut <strong>configurer le cache</strong> pour les couches à intégrer. De même, bien noter les options choisies ici (format d&#8217;image, metatile, expiration) pour les utiliser telles quelles dans les projets fils.</li>
<li>Il est possible de <strong>masquer le projet</strong> dans la page d&#8217;acceuil de Lizmap via la case à cocher <em>Masquer le projet dans Lizmap Web Client</em> de l&#8217;onglet <em>Carte</em> du plugin.</li>
</ul>
</li>
<li><strong>Ouvrir le projet fils</strong>, et <em>intégrer des couches ou des groupes dans ce projet</em>, par exemple une orthophotographie. Ensuite il faut :<ul>
<li>vérifier que l&#8217;<strong>emprise annonceé</strong> dans les propriétés du projet QGIS / Serveur OwS est <strong>exactement la même que celle du projet parent</strong></li>
<li>il faut <strong>configurer le cache</strong> pour la couche intégrée <strong>avec exactement les mêmes options que celles choisies dans le projet parent</strong> : format d&#8217;image, expiration, metatile</li>
<li>il faut renseigner l&#8217;identifiant Lizmap du <strong>Répertoire source</strong> du projet parent (celui configuré dans l&#8217;interface d&#8217;administration de Lizmap Web Client)</li>
<li>le code du <strong>Projet source</strong> (le nom du projet QGIS parent sans l&#8217;extension .qgs) est renseigné automatiquement pour les couches et les groupes intégrés.</li>
</ul>
</li>
<li><strong>Publier le projet fils</strong> vers l&#8217;application Lizmap Web Client, comme d&#8217;habitude.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="map-tab.html" title="Carte - Configurer la carte web avec le plugin"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Interface - Les onglets"
             >previous</a> |</li>
        <li><a href="../../index.html">Lizmap 1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Le plugin Lizmap pour QGIS</a> &raquo;</li>
          <li><a href="index.html" >Interface - Les onglets</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, 3liz.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>